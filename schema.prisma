generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./app.db"
}

model User {
  Id          Int      @id @default(autoincrement())
  Username    String   @unique
  Password    String
  Salt        String
  Permissions BigInt   @default(5)
  CreatedAt   DateTime @default(now())
  UpdatedAt   DateTime @updatedAt
  Urls        Url[]
  Files       File[]
  Invites     Invite[]
}

model Invite {
  Id        Int    @id @default(autoincrement())
  Invite    String @unique
  UsedBy    Int?
  Creator   User?  @relation(fields: [CreatorId], references: [Id])
  CreatorId Int?
}

model File {
  Id           Int      @id @default(autoincrement())
  Filename     String   @unique
  DisplayName  String
  DownloadName String
  IndexFile    Boolean
  FileSize     Int
  MD5          String
  MimeType     String
  Language     String?
  AddedAt      DateTime @default(now())
  UpdatedAt    DateTime @updatedAt
  Owner        User?    @relation(fields: [OwnerId], references: [Id])
  OwnerId      Int?
}

model Url {
  Id      Int    @id @default(autoincrement())
  Key     String @unique
  Url     String
  Owner   User   @relation(fields: [OwnerId], references: [Id])
  OwnerId Int
}

model UrlStats {
  Id         Int      @id
  VisitCount Int      @default(0)
  MaxVisits  Int      @default(0)
  Timestamp  DateTime @default(now())
}

model Session {
  Id        String   @id
  UserId    Int
  Expires   DateTime
  CreatedAt DateTime @default(now())
}
